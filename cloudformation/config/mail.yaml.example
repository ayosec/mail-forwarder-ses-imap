template:
  path: mail-forwarder.py
  type: file

parameters:
  # The name of the rule-set where the new rule is added.
  #
  # In order to be able to receive emails, the rule has to be added to the
  # active rule-set. This name can be queried with the following command:
  #
  #   $ aws ses describe-active-receipt-rule-set --region eu-west-1 --query 'Metadata.Name'
  #
  # If you don't have any, then you have to create one before using this
  # template.
  SesRuleSetName: "DEFAULT"

  # The name of the bucket to store received emails.
  #
  # It is required explicitly (instead of using a random name generated by
  # CloudFormation) to avoid circular dependencies with the SNS configuration.
  #
  # You can generate a random name with the following command:
  #
  #   $ printf 'mail-forwarder-%s\n' $(openssl rand -hex 16)
  BucketName: "mail-forwarder-<RANDOM>"

  # The address that will receive emails.
  #
  # To configure a domain, follow the instructions at
  # https://docs.aws.amazon.com/ses/latest/dg/receiving-email-setting-up.html
  Recipient: "name@example.com"

  # Configuration of the IMAP server.
  ImapMailbox: "Inbox"
  ImapHost: !environment_variable IMAP_HOST
  ImapUser: !environment_variable IMAP_USER
  ImapPassword: !environment_variable IMAP_PASSWORD
